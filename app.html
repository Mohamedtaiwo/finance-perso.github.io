<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceHelper - Dashboard</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <header>
        <button class="mobile-menu-toggle">‚ò∞</button>
        <div class="logo-container">
            <div class="logo">üí∞</div>
            <div class="app-name">FinanceHelper</div>
        </div>
        <div class="user-menu">
            <div class="user-email" id="user-email">utilisateur@exemple.com</div>
            <button class="logout-btn" id="logout-btn">D√©connexion</button>
        </div>
    </header>

    <div class="container">
        <aside class="sidebar">
            <div class="nav-section">
                <div class="nav-section-title">Principal</div>
                <div class="nav-item active" data-section="dashboard">
                    <div class="nav-item-icon">üìä</div>
                    <div class="nav-item-text">Tableau de bord</div>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-section-title">Finances</div>
                <div class="nav-item" data-section="income">
                    <div class="nav-item-icon">üí∞</div>
                    <div class="nav-item-text">Revenus</div>
                </div>
                <div class="nav-item" data-section="subscriptions">
                    <div class="nav-item-icon">üìë</div>
                    <div class="nav-item-text">Abonnements</div>
                </div>
                <div class="nav-item" data-section="expenses">
                    <div class="nav-item-icon">üõí</div>
                    <div class="nav-item-text">D√©penses</div>
                </div>
                <div class="nav-item" data-section="savings">
                    <div class="nav-item-icon">üè¶</div>
                    <div class="nav-item-text">√âpargne</div>
                </div>
                <div class="nav-item" data-section="investments">
                    <div class="nav-item-icon">üìà</div>
                    <div class="nav-item-text">Investissements</div>
                </div>
                <div class="nav-item" data-section="debt">
                    <div class="nav-item-icon">üßæ</div>
                    <div class="nav-item-text">Dettes</div>
                </div>
                <div class="nav-item" data-section="loaners">
                    <div class="nav-item-icon">üßç‚Äç‚ôÇÔ∏è</div>
                    <div class="nav-item-text">Pr√™ts aux autres</div>
                </div>
            </div>
        </aside>

        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="active">
                <h1 class="page-title">Tableau de bord</h1>

                <div class="dashboard-summary">
                    <div class="summary-card">
                        <div class="card-header">
                            <div class="card-title">Revenus mensuels</div>
                            <div class="card-icon income-icon">üí∞</div>
                        </div>
                        <div class="card-value" id="income-value">0 ‚Ç¨</div>
                        <div class="card-subtitle">Salaire et autres revenus</div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <div class="card-title">D√©penses mensuelles</div>
                            <div class="card-icon expenses-icon">üõí</div>
                        </div>
                        <div class="card-value" id="expenses-value">0 ‚Ç¨</div>
                        <div class="card-subtitle">Abonnements et d√©penses quotidiennes</div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <div class="card-title">√âpargne actuelle</div>
                            <div class="card-icon savings-icon">üè¶</div>
                        </div>
                        <div class="card-value" id="savings-value">0 ‚Ç¨</div>
                        <div class="card-subtitle">Progression vers vos objectifs</div>
                    </div>

                    <div class="summary-card">
                        <div class="card-header">
                            <div class="card-title">Investissements</div>
                            <div class="card-icon investments-icon">üìà</div>
                        </div>
                        <div class="card-value" id="investments-value">0 ‚Ç¨</div>
                        <div class="card-subtitle">Capital investi</div>
                    </div>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <div class="card-title">Solde disponible ce mois-ci</div>
                    </div>
                    <div class="card-value" id="balance-value">0 ‚Ç¨</div>
                    <div class="card-subtitle">apr√®s abonnements et d√©penses planifi√©es</div>
                </div>

                <!-- Nouvelles cartes pour les recommandations -->
                <div class="summary-card" id="daily-budget-card" style="margin-top: 1rem;">
                    <div class="card-header">
                        <div class="card-title">Budget quotidien recommand√©</div>
                    </div>
                    <div class="card-value" id="daily-budget-value">0 ‚Ç¨</div>
                    <div class="card-subtitle">pour les <span id="remaining-days">0</span> jours restants du mois</div>
                </div>

                <div class="summary-card" id="savings-recommendations" style="margin-top: 1rem;">
                    <div class="card-header">
                        <div class="card-title">Recommandations d'√©pargne</div>
                    </div>
                    <div id="savings-recommendations-content">
                        <div class="card-subtitle">Ajoutez des objectifs d'√©pargne pour voir des recommandations</div>
                    </div>
                </div>

                <div class="summary-card" id="investment-recommendation" style="margin-top: 1rem;">
                    <div class="card-header">
                        <div class="card-title">Investissement recommand√©</div>
                    </div>
                    <div class="card-value" id="investment-recommendation-value">0 ‚Ç¨</div>
                    <div class="card-subtitle">montant sugg√©r√© pour ce mois</div>
                </div>

                <div class="summary-card" id="debt-priorities" style="margin-top: 1rem;">
                    <div class="card-header">
                        <div class="card-title">Recommandations de remboursement</div>
                    </div>
                    <div id="debt-priorities-content">
                        <div class="card-subtitle">Ajoutez des dettes pour voir des recommandations</div>
                    </div>
                </div>

                <div class="summary-card" id="loaners-summary" style="margin-top: 1rem;">
                    <div class="card-header">
                        <div class="card-title">Total des pr√™ts aux autres</div>
                    </div>
                    <div class="card-value" id="loaners-total-dashboard">0 ‚Ç¨</div>
                    <div class="card-subtitle">montant total pr√™t√© √† d'autres personnes</div>
                </div>
            </section>

            <!-- Income Section -->
            <section id="income">
                <div class="section-header">
                    <h2 class="section-title">Gestion des revenus</h2>
                    <button class="action-button" id="add-income-btn">+ Ajouter un revenu</button>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <div class="card-title">Salaire mensuel</div>
                    </div>
                    <div class="card-value" id="salary-value">0 ‚Ç¨</div>
                    <button class="action-button" id="edit-salary-btn" style="margin-top: 1rem;">Modifier</button>
                </div>

                <div class="section-header" style="margin-top: 2rem;">
                    <h3 class="section-title">Autres revenus</h3>
                </div>

                <table class="data-table" id="other-income-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Montant</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="other-income-body">
                        <!-- Other income items will be inserted here -->
                    </tbody>
                </table>
            </section>

            <!-- Subscriptions Section -->
            <section id="subscriptions">
                <div class="section-header">
                    <h2 class="section-title">Gestion des abonnements</h2>
                    <button class="action-button" id="add-subscription-btn">+ Ajouter un abonnement</button>
                </div>

                <table class="data-table" id="subscriptions-table">
                    <thead>
                        <tr>
                            <th>Service</th>
                            <th>Montant</th>
                            <th>Fr√©quence</th>
                            <th>Date de pr√©l√®vement</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="subscriptions-body">
                        <!-- Subscription items will be inserted here -->
                    </tbody>
                </table>

                <div class="summary-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <div class="card-title">Total des abonnements mensuels</div>
                    </div>
                    <div class="card-value" id="subscriptions-total">0 ‚Ç¨</div>
                </div>
            </section>

            <!-- Expenses Section -->
            <section id="expenses">
                <div class="section-header">
                    <h2 class="section-title">D√©penses quotidiennes</h2>
                    <button class="action-button" id="add-expense-btn">+ Ajouter une d√©pense</button>
                </div>

                <div class="summary-card" style="margin-bottom: 1.5rem;">
                    <div class="card-header">
                        <div class="card-title">Budget quotidien recommand√©</div>
                    </div>
                    <div class="card-value" id="daily-budget-expenses">0 ‚Ç¨</div>
                    <div class="card-subtitle">pour les <span id="remaining-days-expenses">0</span> jours restants du mois</div>
                </div>

                <table class="data-table" id="expenses-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Montant</th>
                            <th>Cat√©gorie</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="expenses-body">
                        <!-- Expense items will be inserted here -->
                    </tbody>
                </table>

                <div class="summary-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <div class="card-title">Total des d√©penses ce mois-ci</div>
                    </div>
                    <div class="card-value" id="expenses-total">0 ‚Ç¨</div>
                </div>
            </section>

            <!-- Savings Section -->
            <section id="savings">
                <div class="section-header">
                    <h2 class="section-title">Gestion de l'√©pargne</h2>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <div class="card-title">√âpargne actuelle</div>
                    </div>
                    <div class="card-value" id="current-savings">0 ‚Ç¨</div>
                    <button class="action-button" id="edit-savings-btn" style="margin-top: 1rem;">Modifier</button>
                </div>

                <div class="section-header" style="margin-top: 2rem;">
                    <h3 class="section-title">Objectifs d'√©pargne</h3>
                    <button class="action-button" id="add-goal-btn">+ Ajouter un objectif</button>
                </div>

                <div id="savings-goals">
                    <!-- Savings goals will be inserted here -->
                </div>
            </section>

            <!-- Investments Section -->
            <section id="investments">
                <div class="section-header">
                    <h2 class="section-title">Gestion des investissements</h2>
                </div>

                <div class="summary-card">
                    <div class="card-header">
                        <div class="card-title">Capital actuellement investi</div>
                    </div>
                    <div class="card-value" id="current-investments">0 ‚Ç¨</div>
                    <button class="action-button" id="edit-investments-btn" style="margin-top: 1rem;">Modifier</button>
                </div>

                <div class="summary-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <div class="card-title">Capacit√© d'investissement mensuelle</div>
                    </div>
                    <div class="card-value" id="monthly-investment-capacity">0 ‚Ç¨</div>
                    <div class="card-subtitle">Calcul√© automatiquement apr√®s √©pargne et d√©penses</div>
                </div>
            </section>

            <!-- Debt Section -->
            <section id="debt">
                <div class="section-header">
                    <h2 class="section-title">Gestion des dettes</h2>
                    <button class="action-button" id="add-debt-btn">+ Ajouter une dette</button>
                </div>

                <table class="data-table" id="debt-table">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th>Montant initial</th>
                            <th>Montant restant</th>
                            <th>Taux d'int√©r√™t</th>
                            <th>Paiement mensuel</th>
                            <th>Priorit√©</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="debt-body">
                        <!-- Debt items will be inserted here -->
                    </tbody>
                </table>

                <div class="summary-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <div class="card-title">Total des dettes</div>
                    </div>
                    <div class="card-value" id="debt-total">0 ‚Ç¨</div>
                </div>
            </section>

            <!-- Loaners Section -->
            <section id="loaners">
                <div class="section-header">
                    <h2 class="section-title">Personnes qui vous doivent de l'argent</h2>
                    <button class="action-button" id="add-loaner-btn">+ Ajouter un pr√™t</button>
                </div>

                <table class="data-table" id="loaners-table">
                    <thead>
                        <tr>
                            <th>Personne</th>
                            <th>Montant</th>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="loaners-body">
                        <!-- Loaner items will be inserted here -->
                    </tbody>
                </table>

                <div class="summary-card" style="margin-top: 2rem;">
                    <div class="card-header">
                        <div class="card-title">Total des pr√™ts en cours</div>
                    </div>
                    <div class="card-value" id="loaners-total">0 ‚Ç¨</div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <!-- Add Income Modal -->
    <div class="modal-backdrop" id="income-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="income-modal-title">Ajouter un revenu</h3>
                <button class="close-modal" id="close-income-modal">&times;</button>
            </div>
            <form id="income-form">
                <div class="form-group">
                    <label for="income-description">Description</label>
                    <input type="text" id="income-description" required>
                </div>
                <div class="form-group">
                    <label for="income-amount">Montant (‚Ç¨)</label>
                    <input type="number" id="income-amount" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="income-date">Date</label>
                    <input type="date" id="income-date" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-income">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Salary Modal -->
    <div class="modal-backdrop" id="salary-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Modifier votre salaire</h3>
                <button class="close-modal" id="close-salary-modal">&times;</button>
            </div>
            <form id="salary-form">
                <div class="form-group">
                    <label for="salary-amount">Salaire mensuel (‚Ç¨)</label>
                    <input type="number" id="salary-amount" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-salary">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Subscription Modal -->
    <div class="modal-backdrop" id="subscription-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="subscription-modal-title">Ajouter un abonnement</h3>
                <button class="close-modal" id="close-subscription-modal">&times;</button>
            </div>
            <form id="subscription-form">
                <div class="form-group">
                    <label for="subscription-service">Service</label>
                    <input type="text" id="subscription-service" required>
                </div>
                <div class="form-group">
                    <label for="subscription-amount">Montant (‚Ç¨)</label>
                    <input type="number" id="subscription-amount" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="subscription-frequency">Fr√©quence</label>
                    <select id="subscription-frequency" required>
                        <option value="monthly">Mensuel</option>
                        <option value="quarterly">Trimestriel</option>
                        <option value="yearly">Annuel</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="subscription-date">Date de pr√©l√®vement</label>
                    <input type="date" id="subscription-date" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-subscription">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div class="modal-backdrop" id="expense-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="expense-modal-title">Ajouter une d√©pense</h3>
                <button class="close-modal" id="close-expense-modal">&times;</button>
            </div>
            <form id="expense-form">
                <div class="form-group">
                    <label for="expense-description">Description</label>
                    <input type="text" id="expense-description" required>
                </div>
                <div class="form-group">
                    <label for="expense-amount">Montant (‚Ç¨)</label>
                    <input type="number" id="expense-amount" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="expense-category">Cat√©gorie</label>
                    <select id="expense-category" required>
                        <option value="food">Alimentation</option>
                        <option value="transport">Transport</option>
                        <option value="leisure">Loisirs</option>
                        <option value="shopping">Shopping</option>
                        <option value="health">Sant√©</option>
                        <option value="other">Autre</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expense-date">Date</label>
                    <input type="date" id="expense-date" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-expense">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Savings Modal -->
    <div class="modal-backdrop" id="savings-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Modifier votre √©pargne</h3>
                <button class="close-modal" id="close-savings-modal">&times;</button>
            </div>
            <form id="savings-form">
                <div class="form-group">
                    <label for="savings-amount">√âpargne actuelle (‚Ç¨)</label>
                    <input type="number" id="savings-amount" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-savings">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Savings Goal Modal -->
    <div class="modal-backdrop" id="goal-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="goal-modal-title">Ajouter un objectif d'√©pargne</h3>
                <button class="close-modal" id="close-goal-modal">&times;</button>
            </div>
            <form id="goal-form">
                <div class="form-group">
                    <label for="goal-description">Description</label>
                    <input type="text" id="goal-description" required>
                </div>
                <div class="form-group">
                    <label for="goal-amount">Montant cible (‚Ç¨)</label>
                    <input type="number" id="goal-amount" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="goal-date">Date cible</label>
                    <input type="date" id="goal-date" required>
                </div>
                <div class="form-group">
                    <label for="goal-priority">Priorit√©</label>
                    <select id="goal-priority" required>
                        <option value="low">Faible</option>
                        <option value="medium" selected>Moyenne</option>
                        <option value="high">Haute</option>
                        <option value="critical">Critique</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-goal">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Investments Modal -->
    <div class="modal-backdrop" id="investments-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Modifier vos investissements</h3>
                <button class="close-modal" id="close-investments-modal">&times;</button>
            </div>
            <form id="investments-form">
                <div class="form-group">
                    <label for="investments-amount">Capital investi (‚Ç¨)</label>
                    <input type="number" id="investments-amount" min="0" step="0.01" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-investments">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Debt Modal -->
    <div class="modal-backdrop" id="debt-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="debt-modal-title">Ajouter une dette</h3>
                <button class="close-modal" id="close-debt-modal">&times;</button>
            </div>
            <form id="debt-form">
                <div class="form-group">
                    <label for="debt-description">Description</label>
                    <input type="text" id="debt-description" required>
                </div>
                <div class="form-group">
                    <label for="debt-initial">Montant initial (‚Ç¨)</label>
                    <input type="number" id="debt-initial" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="debt-remaining">Montant restant (‚Ç¨)</label>
                    <input type="number" id="debt-remaining" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="debt-rate">Taux d'int√©r√™t (%)</label>
                    <input type="number" id="debt-rate" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="debt-payment">Paiement mensuel (‚Ç¨)</label>
                    <input type="number" id="debt-payment" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="debt-priority">Priorit√© de remboursement</label>
                    <select id="debt-priority" required>
                        <option value="low">Faible</option>
                        <option value="medium" selected>Moyenne</option>
                        <option value="high">Haute</option>
                        <option value="critical">Urgente</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-debt">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Loaner Modal -->
    <div class="modal-backdrop" id="loaner-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="loaner-modal-title">Ajouter un pr√™t</h3>
                <button class="close-modal" id="close-loaner-modal">&times;</button>
            </div>
            <form id="loaner-form">
                <div class="form-group">
                    <label for="loaner-person">Personne</label>
                    <input type="text" id="loaner-person" required>
                </div>
                <div class="form-group">
                    <label for="loaner-amount">Montant (‚Ç¨)</label>
                    <input type="number" id="loaner-amount" min="0" step="0.01" required>
                </div>
                <div class="form-group">
                    <label for="loaner-date">Date</label>
                    <input type="date" id="loaner-date" required>
                </div>
                <div class="form-group">
                    <label for="loaner-description">Description</label>
                    <input type="text" id="loaner-description" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-button" id="cancel-loaner">Annuler</button>
                    <button type="submit" class="action-button">Enregistrer</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Script pour corriger l'affichage apr√®s connexion et la navigation -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // V√©rifier si un utilisateur est connect√©
        const currentUser = sessionStorage.getItem('currentUser');
        
        if (!currentUser) {
            // Rediriger vers la page de connexion si aucun utilisateur n'est connect√©
            window.location.href = 'index.html';
            return;
        }
        
        // Afficher l'email de l'utilisateur dans l'interface
        const userEmailElement = document.getElementById('user-email');
        if (userEmailElement) {
            userEmailElement.textContent = currentUser;
        }
        
        // Activer la navigation par d√©faut sur le tableau de bord
        const dashboardNavItem = document.querySelector('.nav-item[data-section="dashboard"]');
        if (dashboardNavItem) {
            // Assurer que la section du tableau de bord est visible
            const dashboardSection = document.getElementById('dashboard');
            if (dashboardSection) {
                // Enlever la classe active de toutes les sections
                document.querySelectorAll('section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Ajouter la classe active √† la section du tableau de bord
                dashboardSection.classList.add('active');
                
                // Ajouter la classe active √† l'√©l√©ment de navigation du tableau de bord
                dashboardNavItem.classList.add('active');
            }
        }
        
        // NOUVEAU CODE: Initialiser la navigation entre les sections
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                // Enlever la classe active de tous les √©l√©ments de navigation et sections
                document.querySelectorAll('.nav-item').forEach(navItem => {
                    navItem.classList.remove('active');
                });
                document.querySelectorAll('section').forEach(section => {
                    section.classList.remove('active');
                });
                
                // Ajouter la classe active √† l'√©l√©ment cliqu√© et √† la section correspondante
                this.classList.add('active');
                const sectionId = this.getAttribute('data-section');
                const section = document.getElementById(sectionId);
                if (section) {
                    section.classList.add('active');
                }
                
                // Fermer le menu mobile s'il est ouvert (pour les petits √©crans)
                if (window.innerWidth <= 768) {
                    const sidebar = document.querySelector('.sidebar');
                    if (sidebar) {
                        sidebar.classList.remove('active');
                    }
                }
            });
        });
        
        // G√©rer le bouton de d√©connexion
        const logoutBtn = document.getElementById('logout-btn');
        if (logoutBtn) {
            logoutBtn.addEventListener('click', function() {
                sessionStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            });
        }
        
        // G√©rer le menu mobile
        const mobileMenuToggle = document.querySelector('.mobile-menu-toggle');
        if (mobileMenuToggle) {
            mobileMenuToggle.addEventListener('click', function() {
                const sidebar = document.querySelector('.sidebar');
                if (sidebar) {
                    sidebar.classList.toggle('active');
                }
            });
        }
    });
    </script>

    <!-- Scripts -->
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/income.js"></script>
    <script src="js/subscriptions.js"></script>
    <script src="js/expenses.js"></script>
    <script src="js/savings.js"></script>
    <script src="js/investments.js"></script>
    <script src="js/debt.js"></script>
    <script src="js/loaners.js"></script>

    <!-- Script de gestion financi√®re avanc√©e -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log("Script de gestion financi√®re avanc√©e charg√©");
        
        // Fonction pour obtenir les donn√©es financi√®res de l'utilisateur actuel
        function getFinanceData() {
            const currentUser = sessionStorage.getItem('currentUser');
            if (!currentUser) return null;
            
            const users = JSON.parse(localStorage.getItem('financeUsers') || '{}');
            if (!users[currentUser] || !users[currentUser].financeData) {
                users[currentUser] = users[currentUser] || {};
                users[currentUser].financeData = {
                    income: { salary: 0, otherIncome: [] },
                    subscriptions: [],
                    expenses: [],
                    savings: { current: 0, goals: [] },
                    investments: { monthly: 0, current: 0 },
                    debt: [],
                    loaners: []
                };
                localStorage.setItem('financeUsers', JSON.stringify(users));
            }
            
            return users[currentUser].financeData;
        }
        
        // Fonction pour sauvegarder les donn√©es financi√®res
        function saveFinanceData(data) {
            const currentUser = sessionStorage.getItem('currentUser');
            if (!currentUser) return false;
            
            const users = JSON.parse(localStorage.getItem('financeUsers') || '{}');
            users[currentUser] = users[currentUser] || {};
            users[currentUser].financeData = data;
            
            localStorage.setItem('financeUsers', JSON.stringify(users));
            return true;
        }
        
        // Formater un montant en devise
        function formatMoney(amount) {
            return new Intl.NumberFormat('fr-FR', {
                style: 'currency',
                currency: 'EUR'
            }).format(amount || 0);
        }
        
        // Calculer le solde mensuel disponible
        function calculateMonthlyBalance() {
            const data = getFinanceData();
            if (!data) return 0;
            
            // Revenus
            const income = data.income?.salary || 0;
            const otherIncome = data.income?.otherIncome?.reduce((total, item) => 
                total + (parseFloat(item.amount) || 0), 0) || 0;
            const totalIncome = income + otherIncome;
            
            // D√©penses fixes (abonnements)
            const subscriptionExpenses = data.subscriptions?.reduce((total, sub) => {
                const amount = parseFloat(sub.amount) || 0;
                if (sub.frequency === 'monthly') return total + amount;
                else if (sub.frequency === 'quarterly') return total + (amount / 3);
                else if (sub.frequency === 'yearly') return total + (amount / 12);
                return total;
            }, 0) || 0;
            
            // D√©penses du mois
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyExpenses = data.expenses?.reduce((total, exp) => {
                if (!exp.date) return total;
                const expDate = new Date(exp.date);
                if (expDate.getMonth() === currentMonth && expDate.getFullYear() === currentYear) {
                    return total + (parseFloat(exp.amount) || 0);
                }
                return total;
            }, 0) || 0;
            
            // Total des d√©penses
            const totalExpenses = subscriptionExpenses + monthlyExpenses;
            
            // Solde disponible
            return totalIncome - totalExpenses;
        }
        
        // Obtenir le nombre de jours restants dans le mois
        function getRemainingDays() {
            const today = new Date();
            const lastDay = new Date(today.getFullYear(), today.getMonth() + 1, 0);
            return lastDay.getDate() - today.getDate() + 1;
        }
        
        // Calculer le budget quotidien recommand√©
        function calculateDailyBudget() {
            const monthlyBalance = calculateMonthlyBalance();
            const remainingDays = getRemainingDays();
            return monthlyBalance / remainingDays;
        }
        
        // Calculer les recommandations d'√©pargne
        function calculateSavingsRecommendations() {
            const data = getFinanceData();
            if (!data || !data.savings || !data.savings.goals || data.savings.goals.length === 0) {
                return [];
            }
            
            const monthlyBalance = calculateMonthlyBalance();
            
            // Garder une r√©serve pour d√©penses impr√©vues (20% du solde)
            const emergencyBuffer = monthlyBalance * 0.2;
            
            // Montant disponible pour l'√©pargne
            const availableForSavings = monthlyBalance - emergencyBuffer;
            
            if (availableForSavings <= 0) {
                return [];
            }
            
            // Convertir les priorit√©s en poids
            const priorityWeights = {
                'low': 1,
                'medium': 2,
                'high': 3,
                'critical': 5
            };
            
            // Calculer le poids total des priorit√©s
            let totalWeight = 0;
            data.savings.goals.forEach(goal => {
                const priority = goal.priority || 'medium';
                totalWeight += priorityWeights[priority] || 2;
            });
            
            // R√©partir le montant disponible selon les priorit√©s
            const recommendations = [];
            
            data.savings.goals.forEach(goal => {
                if (!goal.targetDate) return;
                
                const targetDate = new Date(goal.targetDate);
                const today = new Date();
                const monthsRemaining = (targetDate.getFullYear() - today.getFullYear()) * 12 + 
                                      (targetDate.getMonth() - today.getMonth());
                
                if (monthsRemaining <= 0) return;
                
                const priority = goal.priority || 'medium';
                const weight = priorityWeights[priority] || 2;
                const shareOfSavings = (weight / totalWeight) * availableForSavings;
                
                // Calculer le montant mensuel id√©al pour atteindre l'objectif
                const idealMonthly = (parseFloat(goal.targetAmount) || 0) / monthsRemaining;
                
                // Prendre le minimum entre le montant id√©al et la part disponible
                const recommendedAmount = Math.min(idealMonthly, shareOfSavings);
                
                recommendations.push({
                    id: goal.id,
                    description: goal.description,
                    targetAmount: goal.targetAmount,
                    targetDate: goal.targetDate,
                    priority: priority,
                    recommendedAmount: recommendedAmount,
                    monthsRemaining: monthsRemaining
                });
            });
            
            return recommendations;
        }
        
        // Calculer la capacit√© d'investissement
        function calculateInvestmentCapacity() {
            const data = getFinanceData();
            if (!data) return 0;
            
            const monthlyBalance = calculateMonthlyBalance();
            
            // R√©serve d'urgence (20% du solde)
            const emergencyBuffer = monthlyBalance * 0.2;
            
            // Objectifs d'√©pargne
            const savingsRecommendations = calculateSavingsRecommendations();
            const totalSavingsRecommended = savingsRecommendations.reduce((total, rec) => 
                total + rec.recommendedAmount, 0);
            
            // Paiements mensuels des dettes
            const debtPayments = data.debt?.reduce((total, debt) => 
                total + (parseFloat(debt.monthlyPayment) || 0), 0) || 0;
            
            // Capacit√© d'investissement
            return Math.max(0, monthlyBalance - emergencyBuffer - totalSavingsRecommended - debtPayments);
        }
        
        // Calculer les priorit√©s de remboursement de dettes
        function calculateDebtPriorities() {
            const data = getFinanceData();
            if (!data || !data.debt || data.debt.length === 0) {
                return [];
            }
            
            const monthlyBalance = calculateMonthlyBalance();
            
            // R√©serve d'urgence (15% du solde)
            const emergencyBuffer = monthlyBalance * 0.15;
            
            // Montant disponible pour les dettes apr√®s √©pargne
            const savingsRecommendations = calculateSavingsRecommendations();
            const totalSavingsRecommended = savingsRecommendations.reduce((total, rec) => 
                total + rec.recommendedAmount, 0);
            
            const availableForDebts = Math.max(0, monthlyBalance - emergencyBuffer - totalSavingsRecommended);
            
            // Si rien n'est disponible, utiliser les montants minimums
            if (availableForDebts <= 0) {
                return data.debt.map(debt => ({
                    id: debt.id,
                    description: debt.description,
                    remainingAmount: debt.remainingAmount,
                    monthlyPayment: debt.monthlyPayment,
                    priority: debt.priority || 'medium',
                    recommendedPayment: parseFloat(debt.monthlyPayment) || 0
                }));
            }
            
            // Convertir les priorit√©s en poids
            const priorityWeights = {
                'low': 1,
                'medium': 2,
                'high': 4,
                'critical': 8
            };
            
            // Trier les dettes par priorit√© et taux d'int√©r√™t
            const sortedDebts = [...data.debt].sort((a, b) => {
                const priorityA = priorityWeights[a.priority || 'medium'] || 2;
                const priorityB = priorityWeights[b.priority || 'medium'] || 2;
                
                if (priorityA !== priorityB) {
                    return priorityB - priorityA; // Priorit√© plus √©lev√©e d'abord
                }
                
                // M√™me priorit√©, trier par taux d'int√©r√™t
                return (parseFloat(b.interestRate) || 0) - (parseFloat(a.interestRate) || 0);
            });
            
            // R√©partir le montant disponible, commencer par les dettes prioritaires
            let remainingForDebts = availableForDebts;
            const recommendations = [];
            
            sortedDebts.forEach(debt => {
                const minPayment = parseFloat(debt.monthlyPayment) || 0;
                let recommendedPayment = minPayment;
                
                // Si haute priorit√© ou taux d'int√©r√™t √©lev√©, allouer plus si possible
                if ((debt.priority === 'high' || debt.priority === 'critical' || 
                    (parseFloat(debt.interestRate) || 0) > 10) && remainingForDebts > minPayment) {
                    
                    // Essayer d'augmenter le paiement de 50% √† 100% selon la priorit√©
                    const multiplier = debt.priority === 'critical' ? 2 : 1.5;
                    const desiredPayment = minPayment * multiplier;
                    
                    // Limiter au montant restant disponible
                    recommendedPayment = Math.min(desiredPayment, remainingForDebts);
                }
                
                remainingForDebts -= recommendedPayment;
                
                recommendations.push({
                    id: debt.id,
                    description: debt.description,
                    remainingAmount: debt.remainingAmount,
                    monthlyPayment: debt.monthlyPayment,
                    priority: debt.priority || 'medium',
                    recommendedPayment: recommendedPayment
                });
            });
            
            return recommendations;
        }
        
        // Calculer le total des pr√™ts aux autres
        function calculateTotalLoans() {
            const data = getFinanceData();
            if (!data || !data.loaners) return 0;
            
            return data.loaners.reduce((total, loaner) => 
                total + (parseFloat(loaner.amount) || 0), 0);
        }
        
        // Mettre √† jour le tableau de bord
        function updateDashboard() {
            const data = getFinanceData();
            if (!data) return;
            
            // Mettre √† jour les valeurs de base
            // Revenus
            const income = data.income?.salary || 0;
            const otherIncome = data.income?.otherIncome?.reduce((total, item) => 
                total + (parseFloat(item.amount) || 0), 0) || 0;
            const totalIncome = income + otherIncome;
            
            document.getElementById('income-value').textContent = formatMoney(totalIncome);
            
            // D√©penses
            const subscriptionExpenses = data.subscriptions?.reduce((total, sub) => {
                const amount = parseFloat(sub.amount) || 0;
                if (sub.frequency === 'monthly') return total + amount;
                else if (sub.frequency === 'quarterly') return total + (amount / 3);
                else if (sub.frequency === 'yearly') return total + (amount / 12);
                return total;
            }, 0) || 0;
            
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyExpenses = data.expenses?.reduce((total, exp) => {
                if (!exp.date) return total;
                const expDate = new Date(exp.date);
                if (expDate.getMonth() === currentMonth && expDate.getFullYear() === currentYear) {
                    return total + (parseFloat(exp.amount) || 0);
                }
                return total;
            }, 0) || 0;
            
            const totalExpenses = subscriptionExpenses + monthlyExpenses;
            document.getElementById('expenses-value').textContent = formatMoney(totalExpenses);
            
            // √âpargne
            document.getElementById('savings-value').textContent = formatMoney(data.savings?.current || 0);
            
            // Investissements
            document.getElementById('investments-value').textContent = formatMoney(data.investments?.current || 0);
            
            // Solde disponible
            const monthlyBalance = calculateMonthlyBalance();
            document.getElementById('balance-value').textContent = formatMoney(monthlyBalance);
            
            // Budget quotidien
            const dailyBudget = calculateDailyBudget();
            const remainingDays = getRemainingDays();
            
            document.getElementById('daily-budget-value').textContent = formatMoney(dailyBudget);
            document.getElementById('remaining-days').textContent = remainingDays;
            
            // Aussi mettre √† jour le budget quotidien sur la page des d√©penses
            document.getElementById('daily-budget-expenses').textContent = formatMoney(dailyBudget);
            document.getElementById('remaining-days-expenses').textContent = remainingDays;
            
            // Recommandations d'√©pargne
            const savingsRecommendations = calculateSavingsRecommendations();
            const savingsRecContent = document.getElementById('savings-recommendations-content');
            
            if (savingsRecommendations.length === 0) {
                savingsRecContent.innerHTML = '<div class="card-subtitle">Ajoutez des objectifs d\'√©pargne pour voir des recommandations</div>';
            } else {
                savingsRecContent.innerHTML = '';
                savingsRecommendations.forEach(rec => {
                    const recItem = document.createElement('div');
                    recItem.className = 'recommendation-item';
                    recItem.style.marginBottom = '0.8rem';
                    
                    recItem.innerHTML = `
                        <div><strong>${rec.description}</strong> (${rec.priority})</div>
                        <div>Recommandation: <span style="font-weight: bold; color: var(--success);">${formatMoney(rec.recommendedAmount)}/mois</span></div>
                        <div>Objectif: ${formatMoney(rec.targetAmount)} d'ici ${rec.monthsRemaining} mois</div>
                    `;
                    
                    savingsRecContent.appendChild(recItem);
                });
            }
            
            // Capacit√© d'investissement
            const investmentCapacity = calculateInvestmentCapacity();
            document.getElementById('investment-recommendation-value').textContent = formatMoney(investmentCapacity);
            document.getElementById('monthly-investment-capacity').textContent = formatMoney(investmentCapacity);
            
            // Recommandations de remboursement de dettes
            const debtPriorities = calculateDebtPriorities();
            const debtPrioritiesContent = document.getElementById('debt-priorities-content');
            
            if (debtPriorities.length === 0) {
                debtPrioritiesContent.innerHTML = '<div class="card-subtitle">Ajoutez des dettes pour voir des recommandations</div>';
            } else {
                debtPrioritiesContent.innerHTML = '';
                debtPriorities.forEach(rec => {
                    const recItem = document.createElement('div');
                    recItem.className = 'recommendation-item';
                    recItem.style.marginBottom = '0.8rem';
                    
                    const difference = rec.recommendedPayment - (parseFloat(rec.monthlyPayment) || 0);
                    
                    recItem.innerHTML = `
                        <div><strong>${rec.description}</strong> (${rec.priority})</div>
                        <div>Paiement recommand√©: <span style="font-weight: bold; color: var(--primary);">${formatMoney(rec.recommendedPayment)}/mois</span></div>
                        <div>Paiement minimum: ${formatMoney(rec.monthlyPayment)}/mois</div>
                        ${difference > 0 ? `<div>Paiement suppl√©mentaire: <span style="color: var(--success);">+${formatMoney(difference)}</span></div>` : ''}
                    `;
                    
                    debtPrioritiesContent.appendChild(recItem);
                });
            }
            
            // Total des pr√™ts aux autres
            const totalLoans = calculateTotalLoans();
            document.getElementById('loaners-total-dashboard').textContent = formatMoney(totalLoans);
        }
        
        // Modifier les formulaires pour prendre en compte les nouvelles fonctionnalit√©s
        
        // Formulaire d'objectif d'√©pargne
        const goalForm = document.getElementById('goal-form');
        if (goalForm) {
            goalForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const description = document.getElementById('goal-description').value;
                const targetAmount = parseFloat(document.getElementById('goal-amount').value);
                const targetDate = document.getElementById('goal-date').value;
                const priority = document.getElementById('goal-priority').value;
                
                const data = getFinanceData();
                if (!data) return;
                
                if (!data.savings) data.savings = { current: 0, goals: [] };
                if (!data.savings.goals) data.savings.goals = [];
                
                const goalId = this.getAttribute('data-id');
                
                if (goalId) {
                    // Mode √©dition
                    const goalIndex = data.savings.goals.findIndex(goal => goal.id && goal.id.toString() === goalId);
                    if (goalIndex !== -1) {
                        data.savings.goals[goalIndex] = {
                            ...data.savings.goals[goalIndex],
                            description,
                            targetAmount,
                            targetDate,
                            priority
                        };
                    }
                } else {
                    // Mode ajout
                    data.savings.goals.push({
                        id: Date.now(),
                        description,
                        targetAmount,
                        targetDate,
                        priority
                    });
                }
                
                if (saveFinanceData(data)) {
                    alert('Objectif d\'√©pargne enregistr√© avec succ√®s!');
                    this.reset();
                    document.getElementById('goal-modal').style.display = 'none';
                    
                    // Mettre √† jour le tableau de bord et la page d'√©pargne
                    updateDashboard();
                    if (window.Savings && typeof window.Savings.updateSavingsPage === 'function') {
                        window.Savings.updateSavingsPage(data);
                    }
                }
            });
        }
        
        // Formulaire de dette
        const debtForm = document.getElementById('debt-form');
        if (debtForm) {
            debtForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const description = document.getElementById('debt-description').value;
                const initialAmount = parseFloat(document.getElementById('debt-initial').value);
                const remainingAmount = parseFloat(document.getElementById('debt-remaining').value);
                const interestRate = parseFloat(document.getElementById('debt-rate').value);
                const monthlyPayment = parseFloat(document.getElementById('debt-payment').value);
                const priority = document.getElementById('debt-priority').value;
                
                const data = getFinanceData();
                if (!data) return;
                
                if (!data.debt) data.debt = [];
                
                const debtId = this.getAttribute('data-id');
                
                if (debtId) {
                    // Mode √©dition
                    const debtIndex = data.debt.findIndex(debt => debt.id && debt.id.toString() === debtId);
                    if (debtIndex !== -1) {
                        data.debt[debtIndex] = {
                            ...data.debt[debtIndex],
                            description,
                            initialAmount,
                            remainingAmount,
                            interestRate,
                            monthlyPayment,
                            priority
                        };
                    }
                } else {
                    // Mode ajout
                    data.debt.push({
                        id: Date.now(),
                        description,
                        initialAmount,
                        remainingAmount,
                        interestRate,
                        monthlyPayment,
                        priority
                    });
                }
                
                if (saveFinanceData(data)) {
                    alert('Dette enregistr√©e avec succ√®s!');
                    this.reset();
                    document.getElementById('debt-modal').style.display = 'none';
                    
                    // Mettre √† jour le tableau de bord et la page des dettes
                    updateDashboard();
                    if (window.Debt && typeof window.Debt.updateDebtPage === 'function') {
                        window.Debt.updateDebtPage(data);
                    }
                }
            });
        }
        
        // Formulaire de d√©pense
        const expenseForm = document.getElementById('expense-form');
        if (expenseForm) {
            expenseForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const description = document.getElementById('expense-description').value;
                const amount = parseFloat(document.getElementById('expense-amount').value);
                const category = document.getElementById('expense-category').value;
                const date = document.getElementById('expense-date').value;
                
                const data = getFinanceData();
                if (!data) return;
                
                if (!data.expenses) data.expenses = [];
                
                const expenseId = this.getAttribute('data-id');
                
                if (expenseId) {
                    // Mode √©dition
                    const expenseIndex = data.expenses.findIndex(expense => expense.id && expense.id.toString() === expenseId);
                    if (expenseIndex !== -1) {
                        data.expenses[expenseIndex] = {
                            ...data.expenses[expenseIndex],
                            description,
                            amount,
                            category,
                            date
                        };
                    }
                } else {
                    // Mode ajout
                    data.expenses.push({
                        id: Date.now(),
                        description,
                        amount,
                        category,
                        date
                    });
                }
                
                if (saveFinanceData(data)) {
                    alert('D√©pense enregistr√©e avec succ√®s!');
                    this.reset();
                    document.getElementById('expense-modal').style.display = 'none';
                    
                    // Mettre √† jour le tableau de bord et la page des d√©penses
                    updateDashboard();
                    if (window.Expenses && typeof window.Expenses.updateExpensesPage === 'function') {
                        window.Expenses.updateExpensesPage(data);
                    }
                }
            });
        }
        
        // Formulaire d'√©pargne
        const savingsForm = document.getElementById('savings-form');
        if (savingsForm) {
            savingsForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const savingsAmount = parseFloat(document.getElementById('savings-amount').value);
                
                const data = getFinanceData();
                if (!data) return;
                
                if (!data.savings) data.savings = { current: 0, goals: [] };
                data.savings.current = savingsAmount;
                
                if (saveFinanceData(data)) {
                    alert('√âpargne mise √† jour avec succ√®s!');
                    document.getElementById('savings-modal').style.display = 'none';
                    
                    // Mettre √† jour le tableau de bord et la page d'√©pargne
                    updateDashboard();
                    if (window.Savings && typeof window.Savings.updateSavingsPage === 'function') {
                        window.Savings.updateSavingsPage(data);
                    }
                }
            });
        }
        
        // Formulaire de pr√™t
        const loanerForm = document.getElementById('loaner-form');
        if (loanerForm) {
            loanerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const person = document.getElementById('loaner-person').value;
                const amount = parseFloat(document.getElementById('loaner-amount').value);
                const date = document.getElementById('loaner-date').value;
                const description = document.getElementById('loaner-description').value;
                
                const data = getFinanceData();
                if (!data) return;
                
                if (!data.loaners) data.loaners = [];
                
                const loanerId = this.getAttribute('data-id');
                
                if (loanerId) {
                    // Mode √©dition
                    const loanerIndex = data.loaners.findIndex(loaner => loaner.id && loaner.id.toString() === loanerId);
                    if (loanerIndex !== -1) {
                        data.loaners[loanerIndex] = {
                            ...data.loaners[loanerIndex],
                            person,
                            amount,
                            date,
                            description
                        };
                    }
                } else {
                    // Mode ajout
                    data.loaners.push({
                        id: Date.now(),
                        person,
                        amount,
                        date,
                        description
                    });
                }
                
                if (saveFinanceData(data)) {
                    alert('Pr√™t enregistr√© avec succ√®s!');
                    this.reset();
                    document.getElementById('loaner-modal').style.display = 'none';
                    
                    // Mettre √† jour le tableau de bord et la page des pr√™ts
                    updateDashboard();
                    if (window.Loaners && typeof window.Loaners.updateLoanersPage === 'function') {
                        window.Loaners.updateLoanersPage(data);
                    }
                }
            });
        }
        
        // √âv√©nements de navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                if (this.getAttribute('data-section') === 'dashboard') {
                    updateDashboard();
                }
            });
        });
        
        // Mettre √† jour le tableau de bord au chargement
        updateDashboard();
    });
    </script>
    <!-- Script pour r√©parer les boutons d'ajout -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log("Script de r√©paration des boutons d'ajout charg√©");
        
        // Fonction pour ouvrir une modale
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                console.log(`Ouverture de la modale: ${modalId}`);
                modal.style.display = 'flex';
            } else {
                console.error(`Modale non trouv√©e: ${modalId}`);
            }
        }
        
        // R√©parer les boutons d'ajout
        const buttonHandlers = [
            { id: 'add-income-btn', modalId: 'income-modal' },
            { id: 'edit-salary-btn', modalId: 'salary-modal' },
            { id: 'add-subscription-btn', modalId: 'subscription-modal' },
            { id: 'add-expense-btn', modalId: 'expense-modal' },
            { id: 'edit-savings-btn', modalId: 'savings-modal' },
            { id: 'add-goal-btn', modalId: 'goal-modal' },
            { id: 'edit-investments-btn', modalId: 'investments-modal' },
            { id: 'add-debt-btn', modalId: 'debt-modal' },
            { id: 'add-loaner-btn', modalId: 'loaner-modal' }
        ];
        
        buttonHandlers.forEach(handler => {
            const button = document.getElementById(handler.id);
            if (button) {
                console.log(`Attachement du gestionnaire au bouton: ${handler.id}`);
                // Supprimer tout gestionnaire existant
                const newButton = button.cloneNode(true);
                button.parentNode.replaceChild(newButton, button);
                
                // Ajouter le nouveau gestionnaire
                newButton.addEventListener('click', function() {
                    console.log(`Bouton cliqu√©: ${handler.id}, ouverture de ${handler.modalId}`);
                    openModal(handler.modalId);
                });
            } else {
                console.error(`Bouton non trouv√©: ${handler.id}`);
            }
        });
        
        // R√©parer les boutons de fermeture des modales
        const closeButtons = [
            { class: 'close-modal', action: 'close' },
            { class: 'cancel-button', action: 'cancel' }
        ];
        
        closeButtons.forEach(buttonClass => {
            document.querySelectorAll(`.${buttonClass.class}`).forEach(button => {
                // Supprimer tout gestionnaire existant
                const newButton = button.cloneNode(true);
                button.parentNode.replaceChild(newButton, button);
                
                // Ajouter le nouveau gestionnaire
                newButton.addEventListener('click', function() {
                    const modal = this.closest('.modal-backdrop');
                    if (modal) {
                        console.log(`Fermeture de la modale: ${modal.id}`);
                        modal.style.display = 'none';
                    }
                });
            });
        });
        
        // Initialiser les dates par d√©faut pour les formulaires
        document.querySelectorAll('input[type="date"]').forEach(input => {
            if (!input.value) {
                input.valueAsDate = new Date();
            }
        });
        
        console.log("R√©paration des boutons termin√©e");
    });
    </script>
</body>
</html>